!function(){"use strict";angular.module("app",["app.core","app.blocks","app.frontend"])}();
!function(){"use strict";angular.module("app.bsfooter",["ngSanitize"])}();
!function(){"use strict";angular.module("app.blocks",["blocks.rows","blocks.headline","blocks.imgresponsive","blocks.text","blocks.videoembed","blocks.soundcloud","blocks.map","blocks.bsbutton"])}();
!function(){"use strict";angular.module("app.core",["app.router"])}();
!function(){"use strict";angular.module("app.frontend",["app.core","app.bsfooter","ngAnimate"])}();
!function(){"use strict";angular.module("app.router",["ui.router"])}();
!function(){"use strict";angular.module("blocks.headline",["duScroll","ngSanitize"])}();
!function(){"use strict";angular.module("blocks.bsbutton",["ngSanitize"])}();
!function(){"use strict";angular.module("blocks.imgresponsive",[])}();
!function(){"use strict";angular.module("blocks.rows",[])}();
!function(){"use strict";angular.module("blocks.map",["uiGmapgoogle-maps"])}();
!function(){"use strict";angular.module("blocks.soundcloud",["ngSanitize"])}();
!function(){"use strict";angular.module("blocks.text",["ngSanitize"])}();
!function(){"use strict";angular.module("blocks.videoembed",["app.core"])}();
!function(){"use strict";angular.module("app.bsfooter").directive("bsfooter",["$q","$sce","dataservice",function(t,o,e){return{restrict:"AEC",template:'<footer ng-bind-html="footerHTML" ng-style="footerStyles"></footer>',replace:!0,link:function(r,n,d){var f=[e.getFooter()];return t.all(f).then(function(t){r.footerStyles={"background-color":t[0].footer.background,color:t[0].footer.text,"padding-top":t[0].footer.paddingTop,"padding-right":t[0].footer.paddingRight,"padding-bottom":t[0].footer.paddingBottom,"padding-left":t[0].footer.paddingLeft},r.footerHTML=o.trustAsHtml(t[0].footer.HTMLContent)})}}}])}();
!function(){"use strict";function r(r,e){r.configure({docTitle:o.appTitle+": ",baseHref:"/"})}var e=angular.module("app.core"),o={appErrorPrefix:"[BSClient Error] ",appTitle:"Blockstory"};e.value("config",o),e.config(r),r.$inject=["routerHelperProvider","$httpProvider"]}();
!function(){"use strict";function t(t,n,o,r,a,i){var l="/404";a.configureStates(e(),l);var p=[i.getCommons(),i.getStyles()];return o.all(p).then(function(e){n.title=e[0].title,n.primaryFont=e[1].styleOptions.type.primaryFont,n.secondaryFont=e[1].styleOptions.type.secondaryFont,n.style='body { font-family: "'+n.secondaryFont+'"; font-size: 1.8rem; }',n.style+='h1,h2,h3,h4,h5,h6 { font-family: "'+n.primaryFont+'" }',n.opengraph={image:e[0].opengraph.image,title:n.title,url:r.$$absUrl,site_name:e[0].opengraph.site_name,type:e[0].opengraph.type};var o=[];for(var a in e[1].styleOptions.type)o.push(e[1].styleOptions.type[a]);t.WebFont.load({google:{families:o},active:function(){}})})}function e(){return[{state:"404",config:{url:"/404",templateUrl:"templates/404.html",title:"404"}}]}angular.module("app.core").run(t),t.$inject=["$window","$rootScope","$q","$location","routerHelper","dataservice"]}();
!function(){"use strict";function n(n,r,t,e,o){function i(){var n=[o.getStory()];return t.all(n).then(function(n){u.rows=n[0].layout.rows,u.hideSpinner=!0})}var u=this;u.hideSpinner=!1,i()}angular.module("app.frontend").filter("object2Array",function(){return function(n){var r=[];for(var t in n)r.push(n[t]);return r}}).controller("FrontendController",n),n.$inject=["$window","$state","$q","$scope","dataservice"]}();
!function(){"use strict";function t(t){t.configureStates(n())}function n(){return[{state:"frontend",config:{url:"/",templateUrl:"templates/frontend.html",controller:"FrontendController",controllerAs:"vm",title:""}}]}angular.module("app.frontend").run(t),t.$inject=["routerHelper"]}();
!function(){"use strict";function t(t,e,o){function n(t,n,a,i){function u(t,n){t.forEach(function(t){t.config.resolve=angular.extend(t.config.resolve||{},r.resolveAlways),e.state(t.state,t.config)}),n&&!d&&(d=!0,o.otherwise(n))}function s(){n.$on("$stateChangeError",function(e,o,n,r,a,i){if(!g){v.errors++,g=!0;var u=o&&(o.title||o.name||o.loadedTemplateUrl)||"unknown target",s="Error routing to "+u+". "+(i.data||"")+". <br/>"+(i.statusText||"")+": "+(i.status||"");console.log(s,[o]),t.path("/")}})}function c(){s(),f()}function l(){return a.get()}function f(){n.$on("$stateChangeStart",function(t,e){angular.element(document.querySelector("#loadingScreen")).removeClass("fadeOut")})}var g=!1,d=!1,v={errors:0,changes:0},$={configureStates:u,getStates:l,stateCounts:v};return c(),$}var r={docTitle:void 0,resolveAlways:{}};t.html5Mode(!0),this.configure=function(t){angular.extend(r,t)},this.$get=n,n.$inject=["$location","$rootScope","$state"]}angular.module("app.router").provider("routerHelper",t),t.$inject=["$locationProvider","$stateProvider","$urlRouterProvider"]}();
!function(){"use strict";function t(t,e,r,o,n){function a(){function e(t){return t.data}function r(t){console.log("XHR Failed for getCommons."+t.data)}var n="?filter[fields][opengraph]=true";n+="&filter[fields][title]=true";var a=f+o+n;return t.get(a).then(e)["catch"](r)}function i(){function e(t){return t.data}function r(t){console.log("XHR Failed for getFooter."+t.data)}var n=f+o+"?filter[fields][footer]=true";return t.get(n).then(e)["catch"](r)}function l(){function e(t){return t.data}function r(t){console.log("XHR Failed for getStyles."+t.data)}var n=f+o+"?filter[fields][styleOptions]=true";return t.get(n).then(e)["catch"](r)}function c(){function e(t){return t.data}function r(t){console.log("XHR Failed for getStory."+t.data)}var n=f+o+"?filter[fields][layout]=true&filter[order]=rowOrder%20DESC";return t.get(n).then(e)["catch"](r)}var f;f=n.remote?"http://5.101.98.193:3000/api/stories/":"http://localhost:3000/api/stories/";var u={getCommons:a,getFooter:i,getStyles:l,getStory:c};return u}angular.module("app.core").factory("dataservice",t),t.$inject=["$http","$q","$filter","storyID","ENV"]}();
!function(){"use strict";function e(e,n){var o=e.defer(),r=o.promise;n.onYouTubeIframeAPIReady=function(){o.resolve()};var u={onReady:function(e){r.then(e)}};return u}angular.module("app.core").factory("youtubeApiService",e),e.$inject=["$q","$window"]}();
!function(){"use strict";angular.module("blocks.headline").directive("headline",["$window","$rootScope","$location","$document","$timeout",function(n,t,i,e,o){return{restrict:"AEC",templateUrl:"templates/blocks/headline/headline.html",replace:!0,scope:{counter:"="},link:function(r,a,l){var s=$(a).find(".headline-about-link-flag"),c=$(a).find(".headline-about-content"),h=$(a).find(".headline-logo"),d=$(a).find(".fb"),f=$(a).find(".tw"),p=$(a).find(".headline-scroll-down"),g=$(a).find(".headline-main-title-inner"),m=r.$parent.rowCtrl.optionsT[r.counter];r.options=m,a.parent()[0].style.padding=0,a.css({height:n.innerHeight+"px",backgroundImage:"url("+m.imgUrl+")"}),o(function(){s.css({fontFamily:t.primaryFont}),c.css({fontFamily:t.primaryFont}),h.css({width:m.logoWidth+"px",height:m.logoHeight+"px",backgroundImage:"url("+m.logoUrl+")"}),a.find("h1").css({fontFamily:t.primaryFont}),a.find("h4").css({fontFamily:t.secondaryFont}),a.find("a").css({fontFamily:t.primaryFont}).attr("target","blank"),d.attr("href","https://www.facebook.com/sharer/sharer.php?u="+i.$$absUrl),f.attr("href","http://twitter.com/share?url="+i.$$absUrl),g.css({marginTop:"-"+g.height()/2+"px"}).addClass("show")},!1),s.on("click",function(n){c.toggleClass("visible")}),p.on("click",function(t){e.scrollTop(n.innerHeight,500)}),n.onresize=function(t){a.css({height:n.innerHeight+"px"}),g.css({marginTop:"-"+g.height()/2+"px"})}}}}])}();
!function(){"use strict";angular.module("blocks.bsbutton").directive("bsbutton",["$window",function(t){return{restrict:"AEC",templateUrl:"templates/blocks/bsbutton/bsbutton.html",replace:!0,scope:{counter:"="},link:function(t,o,e){var n={position:"fixed",top:0,left:0,"z-index":100},i={position:"fixed",bottom:0,left:0,"z-index":100};switch(t.opt=t.$parent.rowCtrl.optionsT[t.counter],t.switches=t.$parent.rowCtrl.switchesT[t.counter],t.switches.blockBtn&&(n.width=i.width="100%"),t.radios=t.$parent.rowCtrl.radiosT[t.counter],t.radios.stick.value){case"top":t.bsButtonPosition=n;break;case"bottom":t.bsButtonPosition=i;break;case"none":t.bsButtonPosition="{}"}}}}])}();
!function(){"use strict";angular.module("blocks.imgresponsive").directive("imgresponsive",function(){return{restrict:"AEC",template:'<div><img class="img-responsive"><p class="img-caption"></p></div>',replace:!0,scope:{counter:"="},link:function(i,t,e){var n=i.$parent.rowCtrl.optionsT[i.counter];t.find("img").attr("src",n.imgUrl),t.find("p").html(n.caption)}}})}();
!function(){"use strict";angular.module("blocks.rows").directive("rows",["$compile",function(r){return{restrict:"E",controller:function(){this.getOptions=function(){console.log(this)}},controllerAs:"rowCtrl",link:function(t,o,i){t.rowCtrl.optionsT=[],t.rowCtrl.htmlParamsT=[],t.rowCtrl.collectionsT=[],t.rowCtrl.switchesT=[],t.rowCtrl.radiosT=[];var e=0,l="";l='<div class="row">',angular.forEach(t.row.layout,function(r,o){var i;i=r.mdoffset?" col-md-offset-"+r.mdoffset:"",l+='<div class="col-md-'+r.spanmd+i+'">',l+="<"+r.directiveName,t.options=r.directiveOptions,t.htmlParams=r.directiveHtmlParams,t.rowCtrl.optionsT[e]=r.directiveOptions,t.rowCtrl.collectionsT[e]=r.directiveCollections,t.rowCtrl.htmlParamsT[e]=r.directiveHtmlParams,t.rowCtrl.switchesT[e]=r.directiveSwitches,t.rowCtrl.radiosT[e]=r.directiveRadios,angular.forEach(r.directiveHtmlParams,function(r,t){l+=" "+t+'="'+r+'"'}),l+=' counter="'+e+'"></'+r.directiveName+">",l+="</div>",e++}),l+="</div>";var c=r(l)(t);o.replaceWith(c)}}}])}();
!function(){"use strict";angular.module("blocks.map").directive("map",["$sce","$http",function(t,e){return{restrict:"E",templateUrl:"templates/blocks/map/map.html",scope:{counter:"="},controller:function(){},link:function(r,o,a){var n=r.$parent.rowCtrl.optionsT[r.counter],s=r.$parent.rowCtrl.collectionsT[r.counter],l=r.$parent.rowCtrl.switchesT[0];r.mapOptions={scrollwheel:!1},r.markerOptions={icon:n.markerIconUrl},r.caption=t.trustAsHtml(n.caption),r.showRoute=l.showRoute||!1,r.routeStroke={color:n.routeColor,weight:n.routeWeight},r.map={center:{latitude:parseFloat(n.centerLat),longitude:parseFloat(n.centerLng)},zoom:parseInt(n.zoom)},r.markers=[];for(var i=0;i<s.markers.length;i++)r.markers.push(s.markers[i]);if(l.showRoute){var c=r.markers.length,p="https://maps.googleapis.com/maps/api/directions/json?",u="origin="+r.markers[0].latitude+","+r.markers[0].longitude,m="&destination="+r.markers[c-1].latitude+","+r.markers[c-1].longitude,h="";if(c>2){h+="&waypoints=";for(var i=1;i<r.markers.length-1;i++)i>1&&(h+="|"),h+=r.markers[i].latitude,h+=",",h+=r.markers[i].longitude}var g="&key=AIzaSyBbZhrsG4LL36hl7io7HtKlO9O0tNdbpK8",d=p+u+m+h+g;e({method:"GET",url:d,headers:{"Content-Type":"application/json; charset=utf-8"}}).then(function(t){r.steps=[];for(var e=t.data.routes[0].legs,o=e.length-1;o>=0;o--)for(var a=e[o].steps.length-1;a>=0;a--){var n={};n.latitude=e[o].steps[a].end_location.lat,n.longitude=e[o].steps[a].end_location.lng,r.steps.push(n)}},function(t){console.log("Error: No data returned")})}$(o).find(".angular-google-map-container").css({height:n.containerHeight})}}}])}();
!function(){"use strict";angular.module("blocks.soundcloud").directive("soundcloud",["$sce",function(o){return{restrict:"AEC",templateUrl:"templates/blocks/soundcloud/soundcloud.html",replace:!0,scope:{counter:"="},link:function(t,e,s){t.opt=t.$parent.rowCtrl.optionsT[t.counter];var u="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/",r="&amp;auto_play=false&amp;hide_related=true&amp;show_comments=false&amp;show_user=true&amp;show_reposts=false&amp;visual=true";t.audioUrl=o.trustAsResourceUrl(u+t.opt.audioID+r)}}}])}();
!function(){"use strict";angular.module("blocks.text").directive("text",["$window",function(t){return{restrict:"AEC",template:'<p ng-bind-html="directiveText"></p>',replace:!0,scope:{counter:"="},link:function(t,e,n){var r=t.$parent.rowCtrl.optionsT[t.counter];t.directiveText=r.txt}}}])}();
!function(){"use strict";angular.module("blocks.videoembed").directive("videoembed",["$window","youtubeApiService",function(e,t){return{restrict:"E",template:"<div></div>",replace:!0,scope:{counter:"="},link:function(e,o,i){function r(e,t){var o=e.params.id||"YTVideo"+Date.now();return t.attr("id",o),new YT.Player(o,{playerVars:{autoplay:0,html5:1,theme:"light",modesbranding:1,color:"white",iv_load_policy:3,showinfo:0,controls:1},width:"100%",videoId:e.options.videoID})}switch(e.options=e.$parent.rowCtrl.optionsT[e.counter],e.params=e.$parent.rowCtrl.htmlParamsT[e.counter],e.options.videoHost){case"youtube":for(var a=document.getElementsByTagName("script"),n=!0,c=a.length;c--;)"https://www.youtube.com/iframe_api"==a[c].src&&(n=!1);if(n){var s=document.createElement("script");s.src="https://www.youtube.com/iframe_api";var p=document.getElementsByTagName("script")[0];p.parentNode.insertBefore(s,p)}var d;t.onReady(function(){d=r(e,o)});break;case"vimeo":}o.after('<p class="video-caption">'+e.options.caption+"</p>")}}}])}();